/*! npr-pym-loader.js - v2.2.0 - 2022-09-11 */

!function(a,b){var c=[],d=function(a){var b=document.createEvent("Event");b.initEvent("npr-pym-loader:"+a,!0,!0),document.dispatchEvent(b)},e=function(){var a=/^https?:\/\/(www(-s1)?\.)?npr\.org/;return!!window.location.href.match(a)},f=function(a){var b=document.createElement("a");b.style.display="none",b.setAttribute("href",a),document.getElementById("main-section").appendChild(b),b.click(),b.parentNode.removeChild(b)},g=function(a,b){if(a){b||d("pym-loaded");for(var g=document.querySelectorAll("[data-pym-loader]:not([data-embed-loaded])"),h=0;h<g.length;++h)null!==g[h].getAttribute("id")?null!==g[h].getAttribute("data-child-src")?(!function(){var b=g[h],d={};if(null!==b.getAttribute("data-pym-trackscroll")&&(d.trackscroll=!0),null!==b.getAttribute("data-pym-scrollwait")){var i=Number(b.getAttribute("data-pym-scrollwait"));isNaN(i)||(d.scrollwait=i)}var j=new a.Parent(b.getAttribute("id"),b.getAttribute("data-child-src"),d);b.setAttribute("data-embed-loaded",""),j.iframe.setAttribute("data-ot-ignore",""),e()&&j.onMessage("pjax-navigate",f),c.push(j)}(),window.npr_pym_loader_loading=void 0):console.error("container element does not have a data-child-src attribute"):console.error("container element does not have an id attribute");return!0}return!1},h=function(a,b,e){if(a&&b){e||d("carebot-loaded");for(var f=c,g=0;g<f.length;++g)null==f[g].el.getAttribute("data-carebot-skip")&&function(){var a=f[g];new b.VisibilityTracker(a.id,function(b){0!==a.el.getElementsByTagName("iframe").length&&a.sendMessage("on-screen",b.bucket)}),e||d("carebot-visibility-added"),document.querySelector("[data-carebot-scroll]")||(e||d("carebot-scroll-added"),a.el.setAttribute("data-carebot-scroll",""),new b.ScrollTracker("storytext",function(b,c){0!==a.el.getElementsByTagName("iframe").length&&a.sendMessage("scroll-depth",JSON.stringify({percent:b,seconds:c}))}))}()}},i="https://pym.nprapps.org/pym.v1.min.js",j="https://carebot.nprapps.org/carebot-tracker.v0.min.js";j=e()?j:null,window.npr_pym_loader_loading||(window.npr_pym_loader_loading=!0,function(b,c){if(void 0!==a){b=b.split(".js")[0];var d={pym:b},e={pym:{exports:"pym"}},f=["require","pym"];c&&(c=c.split(".js")[0],d.carebot=c,e.carebot={exports:"carebot"},f.push("carebot"));var i="context_loader_"+b.split("/").slice(-1)[0];return a.config({context:i,paths:d,shim:e})(f,function(a,b,c){g(b),c&&h(b,c)}),!0}return!1}(i,j)||function(a,c){return void 0!==b&&"function"==typeof b.getScript&&(b.getScript(a).done(function(){b(function(){g(window.pym),c&&b.getScript(c).done(function(){h(window.pym,window.CarebotTracker)})})}).fail(function(){console.error("could not load pym with jQuery"),window.npr_pym_loader_loading=void 0}),!0)}(i,j)||function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,d.onload=function(){if(c&&d.parentNode&&c.removeChild(d),g(window.pym),b){c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.type="text/javascript",a.src=b,a.onload=function(){c&&a.parentNode&&c.removeChild(a),h(window.pym,window.CarebotTracker)},c.appendChild(a)}},d.onerror=function(){console.error("could not append pym via embedding"),window.npr_pym_loader_loading=void 0},c.appendChild(d)}(i,j))}(window.requirejs,window.jQuery);